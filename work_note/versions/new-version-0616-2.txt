1、配置新合约

2、发布新代码前执行
ALTER TABLE `auction_record` ADD COLUMN `auto_confirm_flag` tinyint(1) COMMENT '拍卖的结束是否由平台的定时任务触发。0-否 1-是' AFTER `ex_contract_address`, CHANGE COLUMN `tx_hash` `tx_hash` varchar(255) DEFAULT NULL COMMENT '交易hash' AFTER `auto_confirm_flag`, CHANGE COLUMN `chain_order_id` `chain_order_id` varchar(200) DEFAULT NULL COMMENT '链上的订单id' AFTER `tx_hash`, CHANGE COLUMN `starting_price` `starting_price` decimal(38,18) DEFAULT NULL AFTER `chain_order_id`, CHANGE COLUMN `tran_price` `tran_price` decimal(38,18) DEFAULT NULL COMMENT '成交价' AFTER `starting_price`, CHANGE COLUMN `winner_bid_id` `winner_bid_id` bigint DEFAULT NULL COMMENT '最终中标的bid_id' AFTER `tran_price`, CHANGE COLUMN `auction_start_time` `auction_start_time` bigint DEFAULT NULL COMMENT '拍卖开始时间' AFTER `winner_bid_id`, CHANGE COLUMN `auction_end_time` `auction_end_time` bigint DEFAULT NULL COMMENT '拍卖结束时间' AFTER `auction_start_time`, CHANGE COLUMN `confirm_time` `confirm_time` bigint DEFAULT NULL COMMENT '确认时间' AFTER `auction_end_time`, CHANGE COLUMN `create_time` `create_time` bigint DEFAULT NULL AFTER `confirm_time`, CHANGE COLUMN `confirm_count` `confirm_count` bigint DEFAULT NULL COMMENT '该次拍卖为平台中的第几次成功的拍卖' AFTER `create_time`;


3、发布后执行的代码
update auction_record set auto_confirm_flag = 0 where ex_contract_address in ("0xB85Bf1D77540c48F27BF46D3025aF188FdF5A763","0xacAEb38961Df532404a989906263Cc4E390a14b9");

//校验
select * from  auction_record  where auto_confirm_flag is null;

