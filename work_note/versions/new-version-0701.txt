CREATE TABLE `retry_task` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `type` tinyint DEFAULT NULL COMMENT '类型 1-confirm任务 2-rebate任务 3-cancel任务',
  `target_task_id` bigint DEFAULT NULL COMMENT 'confirm/rebate/cancel任务的id',
  `chain_order_id` varchar(255) DEFAULT NULL COMMENT '冗余字段，链上的订单id',
  `auction_record_id` bigint DEFAULT NULL COMMENT '冗余字段，拍卖id',
  `artwork_id` bigint DEFAULT NULL COMMENT 'NFT Id，冗余字段',
  `retry_count` int DEFAULT NULL COMMENT '已重试次数',
  `status` tinyint DEFAULT NULL COMMENT '0-未成功 1-已成功 2-重试次数已达到但依然未成功',
  `last_retry_time` bigint DEFAULT NULL COMMENT '上一次重试的时间',
  `next_retry_time` bigint DEFAULT NULL COMMENT '下一次重试的时间',
  `create_time` bigint DEFAULT NULL COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `idx_status_next_time` (`status`,`next_retry_time`) USING BTREE,
  KEY `idx_type_target_id` (`type`,`target_task_id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;

ALTER TABLE `activity` ADD INDEX `idx_from_user_id` (`from_user_id`) comment '', ADD INDEX `idx_to_user_id` (`to_user_id`) comment '';

ALTER TABLE `rebate_task` ADD INDEX `idx_status` USING BTREE (`status`) comment '', ADD INDEX `idx_auction_id` (`auction_record_id`) comment '';
ALTER TABLE `cancel_task` ADD INDEX `status` USING BTREE (`status`) comment '', ADD INDEX `auction_id` USING BTREE (`auction_record_id`) comment '';
ALTER TABLE `confirm_record` ADD INDEX `status` USING BTREE (`status`) comment '', ADD INDEX `auction_id` USING BTREE (`auction_id`) comment '';
ALTER TABLE `customer` DROP INDEX `wallet_address`, ADD UNIQUE `wallet_address` USING BTREE (`wallet_address`) comment '';