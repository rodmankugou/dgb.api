select status,count(status) from auction_record group by status;

select id,chain_order_id,artwork_id from auction_record where status = 6;

#获取确认中的拍卖id列表
select group_concat(id,'@') from auction_record where status = 11;
select group_concat(artwork_id,'@') from auction_record where status = 11;

156359@,157519@,164322@,173542@,175037@,176212@,204093@,206398@,242519@,259477@,274022@,278620@,288054@,291320@,294125@,307303@,321427@,335676@,335929@,349310@,360644

#获取确认中的拍卖的准确状态
select id ,(select max(type) from chain_tx ct where ct.ex_contract_address = auc.ex_contract_address and ct.chain_order_id = auc.chain_order_id) as c_status from auction_record auc where auc.status = 11;
select ct.* from chain_tx ct join auction_record auc on (ct.ex_contract_address = auc.ex_contract_address and ct.chain_order_id = auc.chain_order_id) where auc.id = 156359;

#检查数据库中状态为交割成功，但实际在链上没成功的auction
select * from auction_record ar where status = 8 and not exists(select id from chain_tx ctx where type = 4 and ctx.ex_contract_address = ar.ex_contract_address and ctx.chain_order_id = ar.chain_order_id );
select * from auction_record ar where status = 9 and need_cancel_flag = 1 and not exists(select id from chain_tx ctx where type = 5 and ctx.ex_contract_address = ar.ex_contract_address and ctx.chain_order_id = ar.chain_order_id );

select ct.* from chain_tx ct join auction_record ar on (ct.ex_contract_address = ar.ex_contract_address and ct.chain_order_id = ar.chain_order_id) where ar.id =156359;

select * from rebate_task where status = 2 and tx_hash = '';

update rebate_task set status = 0 where status = 2 and tx_hash = '';

#selectChainTxByAuctionId
select ctx.* from chain_tx ctx
    join auction_record ar on ( ctx.chain_order_id = ar.chain_order_id and ar.ex_contract_address = ctx.ex_contract_address)
where ar.id = 48854
exOrder by type desc;

#未取消的订单
select count(*) from auction_record where status = 4 and need_cancel_flag  = 1 and id not in (select auction_record_id from cancel_task);

#取消成功，但是同步不成功的订单
select count(*) from auction_record where status = 10 and need_cancel_flag  = 1 and id  in (select auction_record_id from cancel_task where status = 1 and tx_hash is not null and tx_hash != '');

select id,chain_order_id from auction_record where status = 10 and need_cancel_flag  = 1 and id  in (select auction_record_id from cancel_task where status = 1 and tx_hash is not null and tx_hash != '');


select count(*) from auction_record where need_cancel_flag = 0  and status = 4;

update auction_record set status = 9 where  need_cancel_flag = 0  and status = 4;

select group_concat(artwork_id) from
    (select * from auction_record where status in (4,10,6) and chain_order_id != 2403) temp;

    512@1442@5184@15166
    3182,27081,11663,512,15166,5184,5184,1442,15166
    select group_concat(distinct artwork_id,'@') from     (select * from auction_record where status in (4,10,6) and chain_order_id != 2403) temp;

    select id ,(select max(type) from chain_tx ct where ct.ex_contract_address = auc.ex_contract_address and ct.chain_order_id = auc.chain_order_id) as c_status from auction_record auc where auc.status = 3;



select distinct(art.status) from artwork art join auction_record ar on (art.id = ar.artwork_id) where ar.status = 11;


select * from auction_record where status not in (8,9) and status < 100 and artwork_id in (9958,8489,6093,714,922);


select ct.* from chain_tx ct join auction_record ar on (ct.ex_contract_address = ar.ex_contract_address and ct.chain_order_id = ar.chain_order_id) where ar.id =33693;