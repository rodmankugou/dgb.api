<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.verificer.biz.biz.mapper.UserMapper">
  <resultMap id="BaseResultMap" type="com.verificer.biz.biz.entity.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="uid" jdbcType="VARCHAR" property="uid" />
    <result column="wx_open_id" jdbcType="VARCHAR" property="wxOpenId" />
    <result column="nickname" jdbcType="VARCHAR" property="nickname" />
    <result column="member_flag" jdbcType="TINYINT" property="memberFlag" />
    <result column="member_s_time" jdbcType="BIGINT" property="memberSTime" />
    <result column="member_e_time" jdbcType="BIGINT" property="memberETime" />
    <result column="member_ip" jdbcType="VARCHAR" property="memberIp" />
    <result column="member_province_code" jdbcType="VARCHAR" property="memberProvinceCode" />
    <result column="member_province_name" jdbcType="VARCHAR" property="memberProvinceName" />
    <result column="member_ref_type" jdbcType="TINYINT" property="memberRefType" />
    <result column="member_ref_id" jdbcType="VARCHAR" property="memberRefId" />
    <result column="member_shop_name" jdbcType="VARCHAR" property="memberShopName" />
    <result column="avatar" jdbcType="VARCHAR" property="avatar" />
    <result column="mobile" jdbcType="VARCHAR" property="mobile" />
    <result column="reg_time" jdbcType="BIGINT" property="regTime" />
    <result column="referrer_flag" jdbcType="BIT" property="referrerFlag" />
    <result column="referrer_enable_flag" jdbcType="BIT" property="referrerEnableFlag" />
    <result column="pos_member_id" jdbcType="BIGINT" property="posMemberId" />
    <result column="invite_commission" jdbcType="DECIMAL" property="inviteCommission" />
    <result column="total_invite_count" jdbcType="INTEGER" property="totalInviteCount" />
    <result column="total_invite_commission" jdbcType="DECIMAL" property="totalInviteCommission" />
    <result column="total_order_count" jdbcType="INTEGER" property="totalOrderCount" />
    <result column="total_order_amount" jdbcType="DECIMAL" property="totalOrderAmount" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, uid, wx_open_id, nickname, member_flag, member_s_time, member_e_time, member_ip, 
    member_province_code, member_province_name, member_ref_type, member_ref_id, member_shop_name, 
    avatar, mobile, reg_time, referrer_flag, referrer_enable_flag, pos_member_id, invite_commission, 
    total_invite_count, total_invite_commission, total_order_count, total_order_amount
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from user
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from user
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.verificer.biz.biz.entity.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into user (uid, wx_open_id, nickname, 
      member_flag, member_s_time, member_e_time, 
      member_ip, member_province_code, member_province_name, 
      member_ref_type, member_ref_id, member_shop_name, 
      avatar, mobile, reg_time, 
      referrer_flag, referrer_enable_flag, pos_member_id, 
      invite_commission, total_invite_count, total_invite_commission, 
      total_order_count, total_order_amount)
    values (#{uid,jdbcType=VARCHAR}, #{wxOpenId,jdbcType=VARCHAR}, #{nickname,jdbcType=VARCHAR}, 
      #{memberFlag,jdbcType=TINYINT}, #{memberSTime,jdbcType=BIGINT}, #{memberETime,jdbcType=BIGINT}, 
      #{memberIp,jdbcType=VARCHAR}, #{memberProvinceCode,jdbcType=VARCHAR}, #{memberProvinceName,jdbcType=VARCHAR}, 
      #{memberRefType,jdbcType=TINYINT}, #{memberRefId,jdbcType=VARCHAR}, #{memberShopName,jdbcType=VARCHAR}, 
      #{avatar,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR}, #{regTime,jdbcType=BIGINT}, 
      #{referrerFlag,jdbcType=BIT}, #{referrerEnableFlag,jdbcType=BIT}, #{posMemberId,jdbcType=BIGINT}, 
      #{inviteCommission,jdbcType=DECIMAL}, #{totalInviteCount,jdbcType=INTEGER}, #{totalInviteCommission,jdbcType=DECIMAL}, 
      #{totalOrderCount,jdbcType=INTEGER}, #{totalOrderAmount,jdbcType=DECIMAL})
  </insert>
  <insert id="insertSelective" parameterType="com.verificer.biz.biz.entity.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into user
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="uid != null">
        uid,
      </if>
      <if test="wxOpenId != null">
        wx_open_id,
      </if>
      <if test="nickname != null">
        nickname,
      </if>
      <if test="memberFlag != null">
        member_flag,
      </if>
      <if test="memberSTime != null">
        member_s_time,
      </if>
      <if test="memberETime != null">
        member_e_time,
      </if>
      <if test="memberIp != null">
        member_ip,
      </if>
      <if test="memberProvinceCode != null">
        member_province_code,
      </if>
      <if test="memberProvinceName != null">
        member_province_name,
      </if>
      <if test="memberRefType != null">
        member_ref_type,
      </if>
      <if test="memberRefId != null">
        member_ref_id,
      </if>
      <if test="memberShopName != null">
        member_shop_name,
      </if>
      <if test="avatar != null">
        avatar,
      </if>
      <if test="mobile != null">
        mobile,
      </if>
      <if test="regTime != null">
        reg_time,
      </if>
      <if test="referrerFlag != null">
        referrer_flag,
      </if>
      <if test="referrerEnableFlag != null">
        referrer_enable_flag,
      </if>
      <if test="posMemberId != null">
        pos_member_id,
      </if>
      <if test="inviteCommission != null">
        invite_commission,
      </if>
      <if test="totalInviteCount != null">
        total_invite_count,
      </if>
      <if test="totalInviteCommission != null">
        total_invite_commission,
      </if>
      <if test="totalOrderCount != null">
        total_order_count,
      </if>
      <if test="totalOrderAmount != null">
        total_order_amount,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="uid != null">
        #{uid,jdbcType=VARCHAR},
      </if>
      <if test="wxOpenId != null">
        #{wxOpenId,jdbcType=VARCHAR},
      </if>
      <if test="nickname != null">
        #{nickname,jdbcType=VARCHAR},
      </if>
      <if test="memberFlag != null">
        #{memberFlag,jdbcType=TINYINT},
      </if>
      <if test="memberSTime != null">
        #{memberSTime,jdbcType=BIGINT},
      </if>
      <if test="memberETime != null">
        #{memberETime,jdbcType=BIGINT},
      </if>
      <if test="memberIp != null">
        #{memberIp,jdbcType=VARCHAR},
      </if>
      <if test="memberProvinceCode != null">
        #{memberProvinceCode,jdbcType=VARCHAR},
      </if>
      <if test="memberProvinceName != null">
        #{memberProvinceName,jdbcType=VARCHAR},
      </if>
      <if test="memberRefType != null">
        #{memberRefType,jdbcType=TINYINT},
      </if>
      <if test="memberRefId != null">
        #{memberRefId,jdbcType=VARCHAR},
      </if>
      <if test="memberShopName != null">
        #{memberShopName,jdbcType=VARCHAR},
      </if>
      <if test="avatar != null">
        #{avatar,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null">
        #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="regTime != null">
        #{regTime,jdbcType=BIGINT},
      </if>
      <if test="referrerFlag != null">
        #{referrerFlag,jdbcType=BIT},
      </if>
      <if test="referrerEnableFlag != null">
        #{referrerEnableFlag,jdbcType=BIT},
      </if>
      <if test="posMemberId != null">
        #{posMemberId,jdbcType=BIGINT},
      </if>
      <if test="inviteCommission != null">
        #{inviteCommission,jdbcType=DECIMAL},
      </if>
      <if test="totalInviteCount != null">
        #{totalInviteCount,jdbcType=INTEGER},
      </if>
      <if test="totalInviteCommission != null">
        #{totalInviteCommission,jdbcType=DECIMAL},
      </if>
      <if test="totalOrderCount != null">
        #{totalOrderCount,jdbcType=INTEGER},
      </if>
      <if test="totalOrderAmount != null">
        #{totalOrderAmount,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.verificer.biz.biz.entity.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update user
    <set>
      <if test="uid != null">
        uid = #{uid,jdbcType=VARCHAR},
      </if>
      <if test="wxOpenId != null">
        wx_open_id = #{wxOpenId,jdbcType=VARCHAR},
      </if>
      <if test="nickname != null">
        nickname = #{nickname,jdbcType=VARCHAR},
      </if>
      <if test="memberFlag != null">
        member_flag = #{memberFlag,jdbcType=TINYINT},
      </if>
      <if test="memberSTime != null">
        member_s_time = #{memberSTime,jdbcType=BIGINT},
      </if>
      <if test="memberETime != null">
        member_e_time = #{memberETime,jdbcType=BIGINT},
      </if>
      <if test="memberIp != null">
        member_ip = #{memberIp,jdbcType=VARCHAR},
      </if>
      <if test="memberProvinceCode != null">
        member_province_code = #{memberProvinceCode,jdbcType=VARCHAR},
      </if>
      <if test="memberProvinceName != null">
        member_province_name = #{memberProvinceName,jdbcType=VARCHAR},
      </if>
      <if test="memberRefType != null">
        member_ref_type = #{memberRefType,jdbcType=TINYINT},
      </if>
      <if test="memberRefId != null">
        member_ref_id = #{memberRefId,jdbcType=VARCHAR},
      </if>
      <if test="memberShopName != null">
        member_shop_name = #{memberShopName,jdbcType=VARCHAR},
      </if>
      <if test="avatar != null">
        avatar = #{avatar,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null">
        mobile = #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="regTime != null">
        reg_time = #{regTime,jdbcType=BIGINT},
      </if>
      <if test="referrerFlag != null">
        referrer_flag = #{referrerFlag,jdbcType=BIT},
      </if>
      <if test="referrerEnableFlag != null">
        referrer_enable_flag = #{referrerEnableFlag,jdbcType=BIT},
      </if>
      <if test="posMemberId != null">
        pos_member_id = #{posMemberId,jdbcType=BIGINT},
      </if>
      <if test="inviteCommission != null">
        invite_commission = #{inviteCommission,jdbcType=DECIMAL},
      </if>
      <if test="totalInviteCount != null">
        total_invite_count = #{totalInviteCount,jdbcType=INTEGER},
      </if>
      <if test="totalInviteCommission != null">
        total_invite_commission = #{totalInviteCommission,jdbcType=DECIMAL},
      </if>
      <if test="totalOrderCount != null">
        total_order_count = #{totalOrderCount,jdbcType=INTEGER},
      </if>
      <if test="totalOrderAmount != null">
        total_order_amount = #{totalOrderAmount,jdbcType=DECIMAL},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.verificer.biz.biz.entity.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update user
    set uid = #{uid,jdbcType=VARCHAR},
      wx_open_id = #{wxOpenId,jdbcType=VARCHAR},
      nickname = #{nickname,jdbcType=VARCHAR},
      member_flag = #{memberFlag,jdbcType=TINYINT},
      member_s_time = #{memberSTime,jdbcType=BIGINT},
      member_e_time = #{memberETime,jdbcType=BIGINT},
      member_ip = #{memberIp,jdbcType=VARCHAR},
      member_province_code = #{memberProvinceCode,jdbcType=VARCHAR},
      member_province_name = #{memberProvinceName,jdbcType=VARCHAR},
      member_ref_type = #{memberRefType,jdbcType=TINYINT},
      member_ref_id = #{memberRefId,jdbcType=VARCHAR},
      member_shop_name = #{memberShopName,jdbcType=VARCHAR},
      avatar = #{avatar,jdbcType=VARCHAR},
      mobile = #{mobile,jdbcType=VARCHAR},
      reg_time = #{regTime,jdbcType=BIGINT},
      referrer_flag = #{referrerFlag,jdbcType=BIT},
      referrer_enable_flag = #{referrerEnableFlag,jdbcType=BIT},
      pos_member_id = #{posMemberId,jdbcType=BIGINT},
      invite_commission = #{inviteCommission,jdbcType=DECIMAL},
      total_invite_count = #{totalInviteCount,jdbcType=INTEGER},
      total_invite_commission = #{totalInviteCommission,jdbcType=DECIMAL},
      total_order_count = #{totalOrderCount,jdbcType=INTEGER},
      total_order_amount = #{totalOrderAmount,jdbcType=DECIMAL}
    where id = #{id,jdbcType=BIGINT}
  </update>
<!--以上内容自动生成-->

  <select id="selectByPosMemberId"  resultMap="BaseResultMap">

    select
    <include refid="Base_Column_List" />
    from user
    where pos_member_id = #{posMemberId}
  </select>

  <sql id="pageCond">
    <if test="mobile != null and mobile != ''">
      AND mobile like  concat(concat("%",#{mobile}),"%")
    </if>
    <if test="nickname != null and nickname != ''">
      AND nickname like  concat(concat("%",#{nickname}),"%")
    </if>
  </sql>

  <select id="page"  resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from user
    where 1 = 1
    <include refid="pageCond"></include>
    order by id desc
    limit #{from},#{limit}
  </select>

  <select id="count"  resultType="int">
    select
      count(*)
    from user
    where 1 = 1
    <include refid="pageCond"></include>

  </select>

  <select id="selectByUid"  resultMap="BaseResultMap">
    select
      *
    from user
    where uid = #{uid}


  </select>

  <select id="selectByWxOpenId"  resultMap="BaseResultMap">
    select
      *
    from user
    where wx_open_id = #{wxOpenId}

  </select>


  <select id="getAndLock"  resultMap="BaseResultMap">
    select
      *
    from user
    where id = #{id}
    for update


  </select>

  <select id="getExpireMemberLimit1"  resultMap="BaseResultMap">
    select
      *
    from user
    where member_flag = 1 and #{now} > member_e_time
    limit 1
  </select>



</mapper>
