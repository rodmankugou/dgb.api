<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.verificer.biz.biz.mapper.ReferrerWithdrawMapper">
  <resultMap id="BaseResultMap" type="com.verificer.biz.biz.entity.ReferrerWithdraw">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="ord_num" jdbcType="VARCHAR" property="ordNum" />
    <result column="user_id" jdbcType="BIGINT" property="userId" />
    <result column="amount" jdbcType="DECIMAL" property="amount" />
    <result column="status" jdbcType="TINYINT" property="status" />
    <result column="remark" jdbcType="VARCHAR" property="remark" />
    <result column="create_time" jdbcType="BIGINT" property="createTime" />
    <result column="review_time" jdbcType="BIGINT" property="reviewTime" />
    <result column="review_staff_id" jdbcType="BIGINT" property="reviewStaffId" />
    <result column="review_staff_name" jdbcType="VARCHAR" property="reviewStaffName" />
    <result column="certificate_img" jdbcType="VARCHAR" property="certificateImg" />
    <result column="transfer_staff_id" jdbcType="BIGINT" property="transferStaffId" />
    <result column="transfer_staff_name" jdbcType="VARCHAR" property="transferStaffName" />
    <result column="transfer_time" jdbcType="BIGINT" property="transferTime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, ord_num, user_id, amount, status, remark, create_time, review_time, review_staff_id, 
    review_staff_name, certificate_img, transfer_staff_id, transfer_staff_name, transfer_time
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from referrer_withdraw
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from referrer_withdraw
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.verificer.biz.biz.entity.ReferrerWithdraw">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into referrer_withdraw (ord_num, user_id, amount, 
      status, remark, create_time, 
      review_time, review_staff_id, review_staff_name, 
      certificate_img, transfer_staff_id, transfer_staff_name, 
      transfer_time)
    values (#{ordNum,jdbcType=VARCHAR}, #{userId,jdbcType=BIGINT}, #{amount,jdbcType=DECIMAL}, 
      #{status,jdbcType=TINYINT}, #{remark,jdbcType=VARCHAR}, #{createTime,jdbcType=BIGINT}, 
      #{reviewTime,jdbcType=BIGINT}, #{reviewStaffId,jdbcType=BIGINT}, #{reviewStaffName,jdbcType=VARCHAR}, 
      #{certificateImg,jdbcType=VARCHAR}, #{transferStaffId,jdbcType=BIGINT}, #{transferStaffName,jdbcType=VARCHAR}, 
      #{transferTime,jdbcType=BIGINT})
  </insert>
  <insert id="insertSelective" parameterType="com.verificer.biz.biz.entity.ReferrerWithdraw">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into referrer_withdraw
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="ordNum != null">
        ord_num,
      </if>
      <if test="userId != null">
        user_id,
      </if>
      <if test="amount != null">
        amount,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="remark != null">
        remark,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="reviewTime != null">
        review_time,
      </if>
      <if test="reviewStaffId != null">
        review_staff_id,
      </if>
      <if test="reviewStaffName != null">
        review_staff_name,
      </if>
      <if test="certificateImg != null">
        certificate_img,
      </if>
      <if test="transferStaffId != null">
        transfer_staff_id,
      </if>
      <if test="transferStaffName != null">
        transfer_staff_name,
      </if>
      <if test="transferTime != null">
        transfer_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="ordNum != null">
        #{ordNum,jdbcType=VARCHAR},
      </if>
      <if test="userId != null">
        #{userId,jdbcType=BIGINT},
      </if>
      <if test="amount != null">
        #{amount,jdbcType=DECIMAL},
      </if>
      <if test="status != null">
        #{status,jdbcType=TINYINT},
      </if>
      <if test="remark != null">
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=BIGINT},
      </if>
      <if test="reviewTime != null">
        #{reviewTime,jdbcType=BIGINT},
      </if>
      <if test="reviewStaffId != null">
        #{reviewStaffId,jdbcType=BIGINT},
      </if>
      <if test="reviewStaffName != null">
        #{reviewStaffName,jdbcType=VARCHAR},
      </if>
      <if test="certificateImg != null">
        #{certificateImg,jdbcType=VARCHAR},
      </if>
      <if test="transferStaffId != null">
        #{transferStaffId,jdbcType=BIGINT},
      </if>
      <if test="transferStaffName != null">
        #{transferStaffName,jdbcType=VARCHAR},
      </if>
      <if test="transferTime != null">
        #{transferTime,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.verificer.biz.biz.entity.ReferrerWithdraw">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update referrer_withdraw
    <set>
      <if test="ordNum != null">
        ord_num = #{ordNum,jdbcType=VARCHAR},
      </if>
      <if test="userId != null">
        user_id = #{userId,jdbcType=BIGINT},
      </if>
      <if test="amount != null">
        amount = #{amount,jdbcType=DECIMAL},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=TINYINT},
      </if>
      <if test="remark != null">
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=BIGINT},
      </if>
      <if test="reviewTime != null">
        review_time = #{reviewTime,jdbcType=BIGINT},
      </if>
      <if test="reviewStaffId != null">
        review_staff_id = #{reviewStaffId,jdbcType=BIGINT},
      </if>
      <if test="reviewStaffName != null">
        review_staff_name = #{reviewStaffName,jdbcType=VARCHAR},
      </if>
      <if test="certificateImg != null">
        certificate_img = #{certificateImg,jdbcType=VARCHAR},
      </if>
      <if test="transferStaffId != null">
        transfer_staff_id = #{transferStaffId,jdbcType=BIGINT},
      </if>
      <if test="transferStaffName != null">
        transfer_staff_name = #{transferStaffName,jdbcType=VARCHAR},
      </if>
      <if test="transferTime != null">
        transfer_time = #{transferTime,jdbcType=BIGINT},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.verificer.biz.biz.entity.ReferrerWithdraw">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update referrer_withdraw
    set ord_num = #{ordNum,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=BIGINT},
      amount = #{amount,jdbcType=DECIMAL},
      status = #{status,jdbcType=TINYINT},
      remark = #{remark,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=BIGINT},
      review_time = #{reviewTime,jdbcType=BIGINT},
      review_staff_id = #{reviewStaffId,jdbcType=BIGINT},
      review_staff_name = #{reviewStaffName,jdbcType=VARCHAR},
      certificate_img = #{certificateImg,jdbcType=VARCHAR},
      transfer_staff_id = #{transferStaffId,jdbcType=BIGINT},
      transfer_staff_name = #{transferStaffName,jdbcType=VARCHAR},
      transfer_time = #{transferTime,jdbcType=BIGINT}
    where id = #{id,jdbcType=BIGINT}
  </update>
<!--以上内容自动生成-->
  <select id="selectByOrdNum" resultMap="BaseResultMap">

    select
    <include refid="Base_Column_List" />
    from referrer_withdraw
    where ord_num = #{ordNum}
  </select>

  <select id="getAndLock" resultMap="BaseResultMap">

    select
    <include refid="Base_Column_List" />
    from referrer_withdraw
    where id = #{id}
    for update
  </select>



  <sql id="pageCond">
    <if test="nickname != null and nickname !=''">
      and u.nickname = #{nickname}
    </if>
    <if test="mobile != null and mobile !=''">
      and u.mobile = #{mobile}
    </if>
    <if test="sTime != null">
      and rw.create_time > #{sTime}
    </if>
    <if test="eTime != null">
      and #{eTime} > rw.create_time
    </if>
  </sql>

  <resultMap id="RefereeRstMap" type="com.verificer.biz.beans.vo.user.withdraw.ReferrerWithdrawVo">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="id" jdbcType="BIGINT" property="id" />
    <result column="uid" jdbcType="VARCHAR" property="uid" />
    <result column="nickname" jdbcType="VARCHAR" property="nickname" />
    <result column="avatar" jdbcType="VARCHAR" property="avatar" />
    <result column="mobile" jdbcType="VARCHAR" property="mobile" />
    <result column="ord_num" jdbcType="VARCHAR" property="ordNum" />
    <result column="create_time" jdbcType="BIGINT" property="createTime" />
    <result column="amount" jdbcType="DECIMAL" property="amount" />
    <result column="status" jdbcType="TINYINT" property="status" />
    <result column="remark" jdbcType="VARCHAR" property="remark" />

  </resultMap>

  <select id="page" resultMap="RefereeRstMap">
    select
            rw.id as id,
            rw.ord_num as ord_num,
            rw.create_time as create_time ,
            rw.amount as amount ,
            u.uid as uid,
            u.nickname as nickname,
            u.avatar as avatar,
            u.mobile as mobile,
            rw.status as status,
            rw.remark as remark
    from referrer_withdraw rw
    left join user u on rw.user_id = u.id
    where  1=1
    <include refid="pageCond"></include>
    order by create_time desc
    limit #{from},#{limit}
  </select>

  <select id="count" resultType="int">
    select count(*)
    from referrer_withdraw rw
    left join user u on rw.user_id = u.id
    where  1=1
    <include refid="pageCond"></include>
  </select>


</mapper>
